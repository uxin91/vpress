<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>electron记录 | 记录 V1.0</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/public/roc.png">
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/assets/css/0.styles.12e0ab05.css" as="style"><link rel="preload" href="/assets/js/app.4b9f0a6a.js" as="script"><link rel="preload" href="/assets/js/2.2dc7f74a.js" as="script"><link rel="preload" href="/assets/js/10.9cbda4be.js" as="script"><link rel="prefetch" href="/assets/js/11.602f6d35.js"><link rel="prefetch" href="/assets/js/12.29fc785f.js"><link rel="prefetch" href="/assets/js/13.836b7877.js"><link rel="prefetch" href="/assets/js/14.5964bedc.js"><link rel="prefetch" href="/assets/js/15.741dfcaf.js"><link rel="prefetch" href="/assets/js/16.859181ea.js"><link rel="prefetch" href="/assets/js/17.ea2ab5b9.js"><link rel="prefetch" href="/assets/js/18.a30b886d.js"><link rel="prefetch" href="/assets/js/19.82560418.js"><link rel="prefetch" href="/assets/js/20.8c2c0626.js"><link rel="prefetch" href="/assets/js/21.8debe47e.js"><link rel="prefetch" href="/assets/js/22.18ad9d9b.js"><link rel="prefetch" href="/assets/js/23.183b6984.js"><link rel="prefetch" href="/assets/js/24.1d0701eb.js"><link rel="prefetch" href="/assets/js/3.3df301be.js"><link rel="prefetch" href="/assets/js/4.81e675e8.js"><link rel="prefetch" href="/assets/js/5.a76c12a1.js"><link rel="prefetch" href="/assets/js/6.5f80c3c1.js"><link rel="prefetch" href="/assets/js/7.d6c07dc4.js"><link rel="prefetch" href="/assets/js/8.16563041.js"><link rel="prefetch" href="/assets/js/9.8b248ae8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.12e0ab05.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="./roc.png" alt="记录 V1.0" class="logo"> <span class="site-name can-hide">记录 V1.0</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  博客首页
</a></div><div class="nav-item"><a href="/shouye/" class="nav-link">
  前端笔记
</a></div><div class="nav-item"><a href="/docs/" class="nav-link router-link-active">
  前端文档
</a></div><div class="nav-item"><a href="/globe/" class="nav-link">
  后端PHP
</a></div><div class="nav-item"><a href="/cloud/" class="nav-link">
  运维实施
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  博客首页
</a></div><div class="nav-item"><a href="/shouye/" class="nav-link">
  前端笔记
</a></div><div class="nav-item"><a href="/docs/" class="nav-link router-link-active">
  前端文档
</a></div><div class="nav-item"><a href="/globe/" class="nav-link">
  后端PHP
</a></div><div class="nav-item"><a href="/cloud/" class="nav-link">
  运维实施
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/docs/" aria-current="page" class="sidebar-link">1. Taro</a></li><li><a href="/docs/electron-doc.html" aria-current="page" class="active sidebar-link">electron记录</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/electron-doc.html#electron记录" class="sidebar-link">electron记录</a></li><li class="sidebar-sub-header"><a href="/docs/electron-doc.html#_1-前端目前能实现的" class="sidebar-link">1：前端目前能实现的</a></li><li class="sidebar-sub-header"><a href="/docs/electron-doc.html#_2-electron介绍" class="sidebar-link">2：electron介绍</a></li><li class="sidebar-sub-header"><a href="/docs/electron-doc.html#_2-1-它能做什么" class="sidebar-link">2.1.它能做什么</a></li><li class="sidebar-sub-header"><a href="/docs/electron-doc.html#_2-2-开发环境" class="sidebar-link">2.2.开发环境</a></li><li class="sidebar-sub-header"><a href="/docs/electron-doc.html#_3-使用electron完成一个简易计算器" class="sidebar-link">3：使用electron完成一个简易计算器</a></li><li class="sidebar-sub-header"><a href="/docs/electron-doc.html#_3-1-初体验-展示一个桌面应用程序界面" class="sidebar-link">3.1.初体验-展示一个桌面应用程序界面</a></li><li class="sidebar-sub-header"><a href="/docs/electron-doc.html#_3-2-添加应用程序的菜单项" class="sidebar-link">3.2.添加应用程序的菜单项</a></li><li class="sidebar-sub-header"><a href="/docs/electron-doc.html#_3-3-主进程和渲染进程" class="sidebar-link">3.3.主进程和渲染进程</a></li><li class="sidebar-sub-header"><a href="/docs/electron-doc.html#_3-4-完成菜单项功能-颜色设置" class="sidebar-link">3.4.完成菜单项功能：颜色设置</a></li><li class="sidebar-sub-header"><a href="/docs/electron-doc.html#_3-5-完成菜单项功能-字体大小设置" class="sidebar-link">3.5.完成菜单项功能：字体大小设置</a></li><li class="sidebar-sub-header"><a href="/docs/electron-doc.html#_3-6-实现桌面端隐藏到托盘" class="sidebar-link">3.6. 实现桌面端隐藏到托盘</a></li><li class="sidebar-sub-header"><a href="/docs/electron-doc.html#_3-7-完成简易的计算功能" class="sidebar-link">3.7.完成简易的计算功能</a></li><li class="sidebar-sub-header"><a href="/docs/electron-doc.html#_4-应用程序打包" class="sidebar-link">4：应用程序打包</a></li><li class="sidebar-sub-header"><a href="/docs/electron-doc.html#_4-2-打包为安装包" class="sidebar-link">4.2 打包为安装包</a></li></ul></li><li><a href="/docs/webpack-doc.html" class="sidebar-link">webpack从入门到进阶</a></li><li><a href="/docs/type-doc.html" class="sidebar-link">TypeScript</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="electron记录"><a href="#electron记录" class="header-anchor">#</a> electron记录</h2> <h2 id="_1-前端目前能实现的"><a href="#_1-前端目前能实现的" class="header-anchor">#</a> 1：前端目前能实现的</h2> <p>现在前端的发展已经到了大前端的时代了。大前端时代是WEB统一的时代，利用html5或者6甚至7，不但可以开发传统的网站，做炫酷的网页动态效果，更可以实现BS架构应用程序、开发手机端web应用，移动端的app应用、移动端Native应用程序、智能设备（比如可穿戴智能手表，可穿戴智能衣服）等，同时使用node.js还可以实现后台开发。甚至还可以实现桌面应用程序的开发。下面我们要介绍的electron就是用来实现跨平台的桌面应用程序开发的。</p> <h2 id="_2-electron介绍"><a href="#_2-electron介绍" class="header-anchor">#</a> 2：electron介绍</h2> <p><a href="https://electronjs.org/" target="_blank" rel="noopener noreferrer">Electron<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>是由Github开发，用HTML，CSS和JavaScript来构建跨平台桌面应用程序的一个开源库。 Electron通过将<a href="https://www.chromium.org/Home" target="_blank" rel="noopener noreferrer">Chromium<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和<a href="https://nodejs.org/" target="_blank" rel="noopener noreferrer">Node.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>合并到同一个运行时环境中，并将其打包为Mac，Windows和Linux系统下的应用来实现这一目的。简单说，electron 是一个可以让我们使用js创建桌面应用程序的框架，并且可以很简单的实现跨平台，让我们可以更轻松的书写业务逻辑，而不用担心跨平台的问题</p> <h2 id="_2-1-它能做什么"><a href="#_2-1-它能做什么" class="header-anchor">#</a> 2.1.它能做什么</h2> <p>Electron 可以让我们使用纯 JavaScript 调用丰富的原生(操作系统) API 来创造桌面应用。除了常规的 HTML5 接口，这些应用能够使用所有的 Node.js 模块，以及 Electron 特有的模块</p> <h2 id="_2-2-开发环境"><a href="#_2-2-开发环境" class="header-anchor">#</a> 2.2.开发环境</h2> <p>你可以使用原生的Node.js开发环境来开发Electron应用。 为了打造一个Electron桌面程序的开发环境，你只需要安装好的Node.js、npm、一个顺手的代码编辑器,同时了解一些操作系统命令行客户端的常规操作</p> <h2 id="_3-使用electron完成一个简易计算器"><a href="#_3-使用electron完成一个简易计算器" class="header-anchor">#</a> 3：使用electron完成一个简易计算器</h2> <h2 id="_3-1-初体验-展示一个桌面应用程序界面"><a href="#_3-1-初体验-展示一个桌面应用程序界面" class="header-anchor">#</a> 3.1.初体验-展示一个桌面应用程序界面</h2> <ul><li><p>electron的下载和引入</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm install electron <span class="token operator">--</span>save<span class="token operator">-</span>dev
npm install electron <span class="token operator">-</span>g
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> app<span class="token punctuation">,</span>BrowserWindow <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span>）
</code></pre></div></li> <li><p>app的ready事件：main.js</p> <ul><li><p>electron会自动的触发ready事件</p></li> <li><p>在这个事件中可以创建electron窗口</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//创建窗口的函数调用</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>electron应用程序窗口的创建(createWindow函数)</p> <ul><li><p>引入BrowserWindow</p></li> <li><p>通过BrowserWindow函数创建窗口对象</p></li> <li><p>对窗口进行配置</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>win <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">width</span><span class="token operator">:</span><span class="token number">390</span><span class="token punctuation">,</span>
    <span class="token literal-property property">height</span><span class="token operator">:</span><span class="token number">670</span><span class="token punctuation">,</span>
    <span class="token comment">//  设置标题</span>
    <span class="token literal-property property">title</span><span class="token operator">:</span><span class="token string">'UXIN计算器'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>electron窗口的常见操作</p> <ul><li><p>加载其它指定的页面</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>win<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'./views/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//使用了path模块生成路径</span>
</code></pre></div></li> <li><p>开启调试工具</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>win<span class="token punctuation">.</span>webContents<span class="token punctuation">.</span><span class="token function">openDevTools</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>添加关闭窗口的事件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>win<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 实现关窗口之后的操作</span>
    win <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token comment">// 关闭主窗口的时候同时也关闭整个应用程序</span>
    app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>electron应用程序的启动</p> <ul><li>electron main.js</li> <li>electron .</li> <li>添加package.json的script配置：&quot;start&quot;: &quot;electron main.js&quot;，之后使用npm start启动electron</li></ul></li></ul> <h2 id="_3-2-添加应用程序的菜单项"><a href="#_3-2-添加应用程序的菜单项" class="header-anchor">#</a> 3.2.添加应用程序的菜单项</h2> <ul><li><p>添加菜单项的方法：Menu.buildFromTemplate(菜单项模板)</p></li> <li><p>创建菜单项模板</p> <ul><li><p>label:菜单项文本设置</p></li> <li><p>click:单击事件，指定事件处理函数</p></li> <li><p>role:指定菜单项的角色</p></li> <li><p>accelerator：触发当前菜单项的快捷键</p></li> <li><p>设置子菜单项：通过submenu设置</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> template <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token literal-property property">label</span><span class="token operator">:</span><span class="token string">'UXIN计算器'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">submenu</span><span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token literal-property property">label</span><span class="token operator">:</span><span class="token string">'退出'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">accelerator</span><span class="token operator">:</span><span class="token string">'F11'</span><span class="token punctuation">,</span>
                <span class="token comment">// role String (可选)-内置事件, 定义菜单项的行为, 当指定 click 属性时将被忽略</span>
                <span class="token literal-property property">role</span><span class="token operator">:</span><span class="token string">'quit'</span><span class="token punctuation">,</span>
                <span class="token function-variable function">click</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                     app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div></li></ul></li> <li><p>添加菜单到应用程序：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Menu<span class="token punctuation">.</span><span class="token function">setApplicationMenu</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span>
</code></pre></div></li></ul> <h2 id="_3-3-主进程和渲染进程"><a href="#_3-3-主进程和渲染进程" class="header-anchor">#</a> 3.3.主进程和渲染进程</h2> <ul><li>主进程：在Electron中运行package.json和main脚本的进程称为主进程。例如，main.js文件属于主进程，同时在main.js文件中直接引入的js文件也属于主进程(如：require('./mainProcess/menu.js'))</li> <li>渲染进程：electron使用Chromium的多进程机制来渲染页面，每个页面拥有一个自己的进程，该进程称为渲染进程。如main.js文件中加载了index.html文件，在index.html文件中引入的index.js就属于渲染进程</li> <li>主进程和渲染进行之间通信的常见方式：(注意,这些方法全部需要在主进程已经创建了BrowserWindow之后才有效)
<ul><li><strong>ipcRenderer用于渲染进程</strong> <ul><li>ipcRenderer.on(channel, listener) --&gt; channel为事件频道,字符串.listener为触发回调函数,用于响应webContent.send()</li> <li>ipcRenderer.send(channel, data) --&gt; 概念同上,用于向ipcMain发送异步信息</li></ul></li> <li><strong>ipcMain用于主进程,响应从渲染进程中发送的消息</strong> <ul><li>ipcMain.on(channel,listener) --&gt; 响应从ipcRender中相同channel</li></ul></li> <li><strong>event.sender</strong>：主进程监听到渲染进程发送的消息，在响应事件回调函数中使用event.sender.send()方法可以向渲染进程发送消息</li> <li><strong>webContent</strong>：ipcMain本身是无法直接发送事件的,只能通过响应事件回调的event来发送,那如果我们想先让主进程发送消息就可以使用webcontent.这个webcontent是在BrowserWIndow实例中的方法
<ul><li>webContent.send(channel,data) --&gt; 主进程向渲染进程发送消息</li></ul></li></ul></li> <li>不同渲染进程之间共享数据
<ul><li>我们可以简单的使用HTML5中提供的API来实现，如localStorage和sessionStorage</li> <li>在electron中，我们可以在主进程中将一个对象存储为全局变量，在渲染进程中通过remote模块进行操作</li></ul></li></ul> <h2 id="_3-4-完成菜单项功能-颜色设置"><a href="#_3-4-完成菜单项功能-颜色设置" class="header-anchor">#</a> 3.4.完成菜单项功能：颜色设置</h2> <ul><li><p>添加设置颜色的静态页面：color.html</p></li> <li><p>添加设置颜色菜单项</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token literal-property property">label</span><span class="token operator">:</span><span class="token string">'颜色'</span><span class="token punctuation">,</span>
        <span class="token function-variable function">click</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">wh_createColorWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>添加单击事件-创建设置颜色窗口</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">wh_createColorWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> win <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">width</span><span class="token operator">:</span><span class="token number">250</span><span class="token punctuation">,</span>
        <span class="token literal-property property">height</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">,</span>
        <span class="token literal-property property">title</span><span class="token operator">:</span><span class="token string">'颜色'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// 加载关于页面</span>
    win<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">&quot;../views/color.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// 设置不再需要菜单块</span>
    win<span class="token punctuation">.</span><span class="token function">setMenu</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>业务实现：主进程中接收渲染进程传递的数据</p> <ul><li><p>渲染进程中引入ipcRenderer</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>ipcRenderer<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>通过ipcRenderer发射事件让主进程进行监听处理</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 渲染进程向主进程发送消息</span>
ipcRenderer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'wh_colortomain'</span><span class="token punctuation">,</span>currentColor<span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>业务实现：渲染进程接收主进程传递的数据</p> <ul><li><p>在主进程中引入ipcMain:在主进程中使用，通过ipcMain可以接收渲染进程中发送过来的消息</p></li> <li><p>监听渲染进程中发射的事件：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 主进程监听渲染进程发送过来的消息</span>
ipcMain<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'wh_colortomain'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span>color</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 设置样式：主进程向渲染发送消息：设置index.html页面中的dom元素的样式</span>
    win<span class="token punctuation">.</span>webContents<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'wh_setColor'</span><span class="token punctuation">,</span>color<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>业务实现：通过单独模块处理颜色设置</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 渲染进程监听主进程发送过来的消息，进行处理</span>
ipcRenderer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'wh_setColor'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span>color</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 设置对应元素的样式</span>
    result_text<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> color
    <span class="token comment">// 将当前用户设置的颜色存储到本地存储中</span>
    localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'userColor'</span><span class="token punctuation">,</span>color<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li></ul> <h2 id="_3-5-完成菜单项功能-字体大小设置"><a href="#_3-5-完成菜单项功能-字体大小设置" class="header-anchor">#</a> 3.5.完成菜单项功能：字体大小设置</h2> <ul><li><p>添加事件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token literal-property property">label</span><span class="token operator">:</span><span class="token string">'字体减小'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">accelerator</span><span class="token operator">:</span><span class="token string">'F12'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">click</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span>cwindow<span class="token punctuation">,</span>event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                cwindow<span class="token punctuation">.</span>webContents<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'sub'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>完成事件处理</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>ipcRenderer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'sub'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取字体大小</span>
    <span class="token keyword">let</span> fontSize <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>result_text<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fontSize
    <span class="token comment">// 调整字体大小</span>
    <span class="token keyword">let</span> fontNum <span class="token operator">=</span> fontSize<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'px'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0</span> <span class="token operator">-</span> <span class="token number">3</span>
    <span class="token comment">// 重置</span>
    result_text<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span>  fontNum <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span>
    localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'userFontSize'</span><span class="token punctuation">,</span>fontNum<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ul> <h2 id="_3-6-实现桌面端隐藏到托盘"><a href="#_3-6-实现桌面端隐藏到托盘" class="header-anchor">#</a> 3.6. 实现桌面端隐藏到托盘</h2> <ul><li><p>tray模块：通过tray可以实现系统托盘功能</p></li> <li><p>我们的需求：在点关闭的时候把window隐藏起来，并且任务栏也一并需要隐藏，在点击系统通知区的图标时再把界面显示出来</p></li> <li><p>引入：const { Tray,Menu } = require('electron')</p></li> <li><p>代码：minProcess/tray.js</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 使用tray可以来实现通知栏图标</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> Menu<span class="token punctuation">,</span> Tray<span class="token punctuation">,</span> dialog <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">createTray</span><span class="token punctuation">(</span><span class="token parameter">win</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> appIcon <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tray</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../images/lar.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment">// 为图标构建菜单项</span>
    <span class="token keyword">const</span> menu <span class="token operator">=</span> Menu<span class="token punctuation">.</span><span class="token function">buildFromTemplate</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">'关闭'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">click</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                dialog<span class="token punctuation">.</span><span class="token function">showMessageBox</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'warning'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'退出提示'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'请问是否真的需要退出？'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">buttons</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'确定'</span><span class="token punctuation">,</span> <span class="token string">'取消'</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        appIcon<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>

    appIcon<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">//我们这里模拟桌面程序点击通知区图标实现打开关闭应用的功能</span>
        win<span class="token punctuation">.</span><span class="token function">isVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> win<span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> win<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        win<span class="token punctuation">.</span><span class="token function">isVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span>win<span class="token punctuation">.</span><span class="token function">setSkipTaskbar</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token operator">:</span>win<span class="token punctuation">.</span><span class="token function">setSkipTaskbar</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 设置鼠标上移时的文本提示</span>
    appIcon<span class="token punctuation">.</span><span class="token function">setToolTip</span><span class="token punctuation">(</span><span class="token string">'应用'</span><span class="token punctuation">)</span>
    <span class="token comment">// 设置菜单项</span>
    appIcon<span class="token punctuation">.</span><span class="token function">setContextMenu</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 暴露成员</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> createTray
</code></pre></div></li></ul> <h2 id="_3-7-完成简易的计算功能"><a href="#_3-7-完成简易的计算功能" class="header-anchor">#</a> 3.7.完成简易的计算功能</h2> <ul><li><p>为dom元素绑定事件</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>calculate<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>AC<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickopt</span><span class="token punctuation">(</span><span class="token string">'+/-'</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>+/-<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickopt</span><span class="token punctuation">(</span><span class="token string">'%'</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>%<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item orange<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickopt</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>÷<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickNum</span><span class="token punctuation">(</span><span class="token string">'7'</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickNum</span><span class="token punctuation">(</span><span class="token string">'8'</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickNum</span><span class="token punctuation">(</span><span class="token string">'9'</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>9<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item orange<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickopt</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>×<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickNum</span><span class="token punctuation">(</span><span class="token string">'4'</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickNum</span><span class="token punctuation">(</span><span class="token string">'5'</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickNum</span><span class="token punctuation">(</span><span class="token string">'6'</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item orange<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickopt</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>-<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickNum</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickNum</span><span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickNum</span><span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item orange<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickopt</span><span class="token punctuation">(</span><span class="token string">'+'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>+<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item large<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickNum</span><span class="token punctuation">(</span><span class="token string">'0'</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">clickNum</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item orange<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">main<span class="token punctuation">.</span><span class="token function">calc</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>单击数字</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">clickNum</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.result-text'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    isPoint <span class="token operator">=</span> num <span class="token operator">===</span> <span class="token string">'.'</span><span class="token punctuation">;</span>
    <span class="token comment">// 数字转为字符串</span>
    result <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 如果输入小数点并且已经结果中已经有小数点了</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> isPoint<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    result <span class="token operator">=</span> result <span class="token operator">+</span> num<span class="token punctuation">;</span>
    res<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>单击运算符</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">clickopt</span><span class="token punctuation">(</span><span class="token parameter">ope</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.result-text'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>ope<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'+/-'</span><span class="token operator">:</span>
            res<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> result <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span>result <span class="token operator">+</span> <span class="token string">'*-1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'%'</span><span class="token operator">:</span>
            res<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> result <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>innerHTML <span class="token operator">+</span> <span class="token string">'/100'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            res<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> result <span class="token operator">=</span> result <span class="token operator">+</span> ope
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>重置</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.result-text'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'0'</span><span class="token punctuation">;</span>
    result <span class="token operator">=</span> <span class="token string">''</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>计算结果</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">calc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    res <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.result-text'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> result <span class="token operator">=</span>  math<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h2 id="_4-应用程序打包"><a href="#_4-应用程序打包" class="header-anchor">#</a> 4：应用程序打包</h2> <p>##4.1 打包为可执行文件</p> <ul><li>安装 <code>electron-packager</code>：npm install --save-dev electron-packager</li> <li>正式打包
<ul><li><p>直接使用命令打包</p> <ul><li>electron-packager &lt;应用目录&gt; &lt;应用名称&gt; &lt;打包平台&gt; --out=&lt;输出目录&gt; &lt;架构&gt; &lt;应用版本&gt; &lt;忽略文件&gt;&lt;图标&gt; --overwrite</li> <li>配置说明:--platform
<ul><li>win: 打包平台：--platform=win32  | 架构：--arch=x64  | 图标：--icon=**.ico</li> <li>mac:打包平台：--platform=darwin| 架构：--arch=x64 | 图标：--icon=**.cins</li></ul></li></ul></li> <li><p>配置package.json命令实现打包</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token string-property property">&quot;packagewin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;electron-packager . xx --out=./dist4 --win --x64 --app-version=0.0.1 --electron-version=2.0.0 --icon=./images/wv.ico --overwrite&quot;</span>
</code></pre></div></li></ul></li></ul> <h2 id="_4-2-打包为安装包"><a href="#_4-2-打包为安装包" class="header-anchor">#</a> 4.2 打包为安装包</h2> <ul><li><p>下载：npm i electron-builder -g</p></li> <li><p>说明：electron-builder可以将应用程序打包为安装文件，如.exe .dmg,对于windows系统打包为.exe,对于mac系统打包为.dmg</p></li> <li><p>实现electron-builder的配置</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token string-property property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;appId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;com.app&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;directories&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;app&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;productName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;计算器&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;dmg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;icon&quot;</span><span class="token operator">:</span><span class="token string">&quot;./images/mac.icns&quot;</span><span class="token punctuation">,</span>
      <span class="token string-property property">&quot;window&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;x&quot;</span><span class="token operator">:</span> <span class="token string">&quot;200&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;y&quot;</span><span class="token operator">:</span> <span class="token string">&quot;150&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;width&quot;</span><span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;height&quot;</span><span class="token operator">:</span> <span class="token number">400</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>，
    <span class="token string-property property">&quot;mac&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;icon&quot;</span><span class="token operator">:</span><span class="token string">&quot;./images/mac.icns&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;win&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;icon&quot;</span><span class="token operator">:</span><span class="token string">&quot;./images/icon.ico&quot;</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>添加script脚本配置：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;packagewin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;electron-packager ./ xx --platform=win32 --out=./dist --arch=x64 --app-version=1.0.1 --icon=./images/icon.ico --overwrite&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;buildmac&quot;</span><span class="token operator">:</span> <span class="token string">&quot;electron-builder --platform=mac --arch=x64&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;electron-builder --win --x64&quot;</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>运行命令：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm run buildwin
</code></pre></div><p>注意：</p> <p>windows下面打包.exe</p> <p>mac下面打包 .dmg</p></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/" class="prev router-link-active">
        1. Taro
      </a></span> <span class="next"><a href="/docs/webpack-doc.html">
        webpack从入门到进阶
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.4b9f0a6a.js" defer></script><script src="/assets/js/2.2dc7f74a.js" defer></script><script src="/assets/js/10.9cbda4be.js" defer></script>
  </body>
</html>
